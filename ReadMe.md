# Restaurant_Dish_Detection_YOLO11

Проект для обнаружения объектов в ресторанной среде с использованием модели YOLO11. Система способна распознавать 16 различных классов объектов: посуда, еда, персонал и посетители ресторана.

## Описание проекта

Этот проект реализует систему для автоматического обнаружения и классификации объектов в ресторанной среде. Используется архитектура YOLO11 для детекции объектов 16 в реальном времени.

## Особенности

- Обучение на кастомном датасете с темпоральным разделением
- Интеграция с Weights & Biases для мониторинга экспериментов
- Конфигурируемые параметры через YAML файлы
- Продвинутая аугментация данных для видео сцен
- Предсказание на изображениях и видео
- Оценка качества модели с детальными метриками
- Поддержка GPU и CPU

## Установка

1. **Клонирование репозитория**
```bash
git clone https: //github.com/PlaeryinBol/Restaurant_Dish_Detection_YOLO11.git
cd Restaurant_Dish_Detection_YOLO11
```

2. **Создание виртуального окружения**
```bash
python -m venv venv
source venv/bin/activate
```

3. **Установка зависимостей**
```bash
pip install -r requirements.txt
```

4. **Настройка Weights & Biases (опционально)**
```bash
wandb login
```

## Структура датасета

Датасет организован с использованием **темпорального разделения** для предотвращения утечки данных (хранится [здесь](https://drive.google.com/drive/folders/1LqMm9-j2ABd46gG7BUPc5ia3wQNvMUYX?usp=sharing) вместе с моделью, показавшей наилучшие метрики *best.pt*).  
Разметка производилась через [CVAT](https://cvat.ai/).

```
dataset/
├── images/
│   ├── train/    # 217 изображений (62.5%)
│   ├── val/      # 90 изображений (26.0%)
│   └── test/     # 40 изображений (11.5%)
├── labels/       # YOLO формат аннотаций
└── data.yaml     # Конфигурация датасета
```

**Принцип разделения**: Кадры из одного временного периода не попадают в разные выборки, что обеспечивает реалистичную оценку обобщающей способности модели.

## Обучение модели

### Настройка параметров
Отредактируйте `config.yaml` для изменения параметров обучения:

### Трейн
```bash
python train.py
```

## Оценка модели

```bash
python evaluate.py --model model.pt
```

## Предикт

### На папке с картинками
```bash
python predict.py --model model.pt --source path/to/images/
```

### На видео
```bash
python predict.py --model model.pt --source video.mov -o video_output.mp4
```

## Конфигурация

### Аугментация данных
Применяется комплекс аугментаций, учитывающий специфику видео данных:
- Геометрические трансформации (поворот, сдвиг, масштаб)
- Цветовые преобразования (HSV)
- Техники мозаики и copy-paste
- Label smoothing для "мягких" границ при движении

## Результаты

Модель обучена на ресторанных сценах с учетом:
- Движения объектов в кадре
- Частичных перекрытий (окклюзий)
- Различного освещения
- Разнообразных углов камеры

### Ключевые метрики
Графики и метрики доступны [здесь](https://wandb.ai/plaeryinbol-everypixel/yolo11_dishes/reports/Restaurant_Dish_Detection_YOLO11--VmlldzoxMzQ1OTk3OQ).  
- **mAP@0.5**: 0.887
- **mAP@0.5: 0.95**: 0.81
- **Precision**: 0.938
- **Recall**: 0.894

                 Class     Images  Instances          P          R      mAP50   mAP50-95
                   all         40        600      0.938      0.895      0.887       0.81
           table knife         35         54      0.984      0.296      0.379      0.342
             empty cup         40         80          1      0.915      0.994       0.92
          glass teapot         40         40       0.99          1      0.995      0.953
               visitor         21         25       0.57        0.6      0.504      0.248
         bowl of salad          5         10      0.973          1      0.995      0.995
      lavash flatbread         21         21      0.986          1      0.995      0.995
            sauce boat         21         42      0.994          1      0.995       0.99
          roasted ribs         21         21       0.98          1      0.995      0.985
          bowl of soup          5         10      0.974          1      0.995      0.795
            tablespoon         21         47      0.951      0.872      0.915      0.723
          paper napkin         40         65      0.717      0.742      0.563      0.467
            table fork         21         42      0.995          1      0.995      0.969
            shot glass         40         40      0.994          1      0.995      0.893
            smartphone         20         20      0.964          1      0.995      0.911
           empty plate         35         83          1      0.995      0.995      0.964

Speed: 2.8ms preprocess, 22.7ms inference, 0.0ms loss, 4.4ms postprocess per image

### Пример результата
![Пример работы модели на видео](output.gif)
